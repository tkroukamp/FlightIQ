{
  "flow": {
    "id": "d8ef72acc932b844a45e8e093ead2cb4",
    "name": "LIVE - [SUBFLOW Ver 1.0.0] - Remove Invalid EMails from MFA"
  },
  "description": "Migrated from TR01-MVC-MFA via FlightIQ Director on 01/12/2026 17:52",
  "alias": "Post-Update (FlightIQ Director) â€” Ver 1.0.0",
  "variables": [
    {
      "context": "company",
      "createdDate": 1767913237081,
      "fields": {
        "type": "string",
        "displayName": "",
        "mutable": true,
        "min": 0,
        "max": 2000,
        "sizeInBytes": 57
      },
      "id": "299e2d4e-8437-4246-a075-475c063aaffe",
      "type": "property",
      "updatedDate": 1771565610091,
      "visibility": "private",
      "name": "invalidEmailDomains##SK##company",
      "companyId": "0b6e6613-ef2c-41d7-9358-c348585fc7ce"
    }
  ],
  "updates": [
    "No updates"
  ],
  "enabled": true,
  "publishedVersion": 8,
  "connectors": [
    {
      "id": "functionsConnector"
    },
    {
      "id": "pingOneSSOConnector"
    },
    {
      "id": "pingOneMfaConnector"
    },
    {
      "id": "httpConnector"
    }
  ],
  "settings": {
    "logLevel": 4,
    "csp": ""
  },
  "color": "#CACED3",
  "graphData": {
    "elements": {
      "nodes": [
        {
          "data": {
            "id": "7reye1na3m",
            "nodeType": "CONNECTION",
            "connectionId": "de650ca45593b82c49064ead10b9fe17",
            "connectorId": "functionsConnector",
            "name": "Functions",
            "label": "Functions",
            "status": "configured",
            "capabilityName": "customFunction",
            "type": "trigger",
            "properties": {
              "variableInputList": {
                "value": [
                  {
                    "name": "domains",
                    "preferredDataType": "string",
                    "value": "[\n  {\n    \"children\": [\n      {\n        \"text\": \"\"\n      },\n      {\n        \"text\": \"\"\n      },\n      {\n        \"type\": \"link\",\n        \"src\": \"variable.svg\",\n        \"url\": \"invalidEmailDomains\",\n        \"data\": \"{{global.company.variables.invalidEmailDomains}}\",\n        \"tooltip\": \"{{global.company.variables.invalidEmailDomains}}\",\n        \"children\": [\n          {\n            \"text\": \"invalidEmailDomains\"\n          }\n        ]\n      },\n      {\n        \"text\": \"\"\n      }\n    ]\n  }\n]"
                  },
                  {
                    "name": "devices",
                    "preferredDataType": "object",
                    "value": "[\n  {\n    \"children\": [\n      {\n        \"text\": \"\"\n      },\n      {\n        \"text\": \"\"\n      },\n      {\n        \"type\": \"link\",\n        \"src\": \"pingIdentity.svg\",\n        \"url\": \"devices\",\n        \"data\": \"{{local.1e8wrbj11b.payload.output.rawResponse._embedded.devices}}\",\n        \"tooltip\": \"{{local.1e8wrbj11b.payload.output.rawResponse._embedded.devices}}\",\n        \"children\": [\n          {\n            \"text\": \"devices\"\n          }\n        ]\n      },\n      {\n        \"text\": \"\"\n      }\n    ]\n  }\n]"
                  }
                ]
              },
              "code": {
                "value": "module.exports = a = async ({params}) => {\n    console.log('params: ', params)\n\n    try {\n        if (!params.domains || typeof params.domains !== 'string') {\n            throw new Error(\"Missing or invalid 'domains' input\")\n        }\n        if (!Array.isArray(params.devices)) {\n            throw new Error(\"Missing or invalid 'devices' input\")\n        }\n\n        const domainList = params.domains\n            .split(',')\n            .map(d => d.trim().toLowerCase())\n            .filter(d => d.length > 0)\n\n        const emailDevices = params.devices.filter(d => \n            d.type === 'EMAIL' && typeof d.email === 'string'\n        )\n\n        for (const device of emailDevices) {\n            const emailDomain = device.email.split('@')[1]?.toLowerCase()\n            if (!emailDomain) continue\n            if (!domainList.includes(emailDomain)) {\n                return { deviceId: device.id }\n            }\n        }\n\n        throw new Error(\"No EMAIL device found with a non-matching domain\")\n    } catch (err) {\n        console.error('Error: ', err)\n        throw new Error(err.message)\n    }\n}\n"
              },
              "outputSchema": {
                "value": "{\n  \"output\": {\n    \"type\": \"object\",\n    \"properties\": {\n      \"deviceId\": {\n        \"type\": \"string\"\n      }\n    }\n  }\n}\n"
              },
              "nodeTitle": {
                "value": "Determine Invalid Email Domains"
              },
              "backgroundColor": {
                "value": "#9b9b9bff"
              }
            }
          },
          "position": {
            "x": 364,
            "y": 356
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        },
        {
          "data": {
            "id": "igvp44kqec",
            "nodeType": "CONNECTION",
            "connectionId": "94141bf2f1b9b59a5f5365ff135e02bb",
            "connectorId": "pingOneSSOConnector",
            "name": "PingOne",
            "label": "PingOne",
            "status": "configured",
            "capabilityName": "userLookup",
            "type": "action",
            "properties": {
              "matchAttributes": {
                "value": [
                  "username"
                ]
              },
              "userIdentifierForFindUser": {
                "value": "[\n  {\n    \"children\": [\n      {\n        \"text\": \"\"\n      },\n      {\n        \"text\": \"\"\n      },\n      {\n        \"type\": \"link\",\n        \"src\": \"auth.svg\",\n        \"url\": \"username\",\n        \"data\": \"{{global.parameters.username}}\",\n        \"tooltip\": \"{{global.parameters.username}}\",\n        \"children\": [\n          {\n            \"text\": \"username\"\n          }\n        ]\n      },\n      {\n        \"text\": \"\"\n      }\n    ]\n  }\n]"
              },
              "nodeTitle": {
                "value": "Get User"
              }
            }
          },
          "position": {
            "x": 364,
            "y": 236
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        },
        {
          "data": {
            "id": "sq4k1w353i",
            "nodeType": "EVAL",
            "label": "Evaluator"
          },
          "position": {
            "x": 484,
            "y": 236
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        },
        {
          "data": {
            "id": "1e8wrbj11b",
            "nodeType": "CONNECTION",
            "connectionId": "b72bd44e6be8180bd5988ac74cd9c949",
            "connectorId": "pingOneMfaConnector",
            "name": "PingOne MFA",
            "label": "PingOne MFA",
            "status": "configured",
            "capabilityName": "readAllDevices",
            "type": "action",
            "properties": {
              "userId": {
                "value": "[\n  {\n    \"children\": [\n      {\n        \"text\": \"\"\n      },\n      {\n        \"text\": \"\"\n      },\n      {\n        \"type\": \"link\",\n        \"src\": \"pingIdentity.svg\",\n        \"url\": \"id\",\n        \"data\": \"{{local.igvp44kqec.payload.output.matchedUser.id}}\",\n        \"tooltip\": \"{{local.igvp44kqec.payload.output.matchedUser.id}}\",\n        \"children\": [\n          {\n            \"text\": \"id\"\n          }\n        ]\n      },\n      {\n        \"text\": \"\"\n      }\n    ]\n  }\n]"
              },
              "setFilterFlag": {
                "value": true
              },
              "deviceTypes": {
                "value": [
                  "EMAIL"
                ]
              },
              "nodeTitle": {
                "value": "Read all EMail Devices"
              }
            }
          },
          "position": {
            "x": 634,
            "y": 236
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        },
        {
          "data": {
            "id": "2wocyzlkv1",
            "nodeType": "EVAL"
          },
          "position": {
            "x": 214,
            "y": 356
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        },
        {
          "data": {
            "id": "j6d583cc1k",
            "nodeType": "EVAL",
            "label": "Evaluator",
            "properties": {
              "50gb66xxzb": {
                "value": "anyTriggersFalse"
              }
            }
          },
          "position": {
            "x": 484,
            "y": 356
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        },
        {
          "data": {
            "id": "ym9toqffq3",
            "nodeType": "CONNECTION",
            "connectionId": "b72bd44e6be8180bd5988ac74cd9c949",
            "connectorId": "pingOneMfaConnector",
            "name": "PingOne MFA",
            "label": "PingOne MFA",
            "status": "configured",
            "capabilityName": "deleteDevice",
            "type": "action",
            "properties": {
              "userId": {
                "value": "[\n  {\n    \"children\": [\n      {\n        \"text\": \"\"\n      },\n      {\n        \"text\": \"\"\n      },\n      {\n        \"type\": \"link\",\n        \"src\": \"pingIdentity.svg\",\n        \"url\": \"id\",\n        \"data\": \"{{local.igvp44kqec.payload.output.matchedUser.id}}\",\n        \"tooltip\": \"{{local.igvp44kqec.payload.output.matchedUser.id}}\",\n        \"children\": [\n          {\n            \"text\": \"id\"\n          }\n        ]\n      },\n      {\n        \"text\": \"\"\n      }\n    ]\n  }\n]"
              },
              "deviceId": {
                "value": "[\n  {\n    \"children\": [\n      {\n        \"text\": \"\"\n      },\n      {\n        \"text\": \"\"\n      },\n      {\n        \"type\": \"link\",\n        \"src\": \"functions.svg\",\n        \"url\": \"deviceId\",\n        \"data\": \"{{local.7reye1na3m.payload.output.deviceId}}\",\n        \"tooltip\": \"{{local.7reye1na3m.payload.output.deviceId}}\",\n        \"children\": [\n          {\n            \"text\": \"deviceId\"\n          }\n        ]\n      },\n      {\n        \"text\": \"\"\n      }\n    ]\n  }\n]"
              },
              "nodeTitle": {
                "value": "Delete Invalid Devices"
              }
            }
          },
          "position": {
            "x": 634,
            "y": 356
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        },
        {
          "data": {
            "id": "50gb66xxzb",
            "nodeType": "CONNECTION",
            "connectionId": "867ed4363b2bc21c860085ad2baa817d",
            "connectorId": "httpConnector",
            "name": "Http",
            "label": "Http",
            "status": "configured",
            "capabilityName": "createSuccessResponse",
            "type": "action",
            "properties": {
              "message": {
                "value": "[\n  {\n    \"children\": [\n      {\n        \"text\": \"\"\n      },\n      {\n        \"text\": \"\"\n      },\n      {\n        \"type\": \"link\",\n        \"src\": \"functions.svg\",\n        \"url\": \"message\",\n        \"data\": \"{{local.7reye1na3m.payload.error.message}}\",\n        \"tooltip\": \"{{local.7reye1na3m.payload.error.message}}\",\n        \"children\": [\n          {\n            \"text\": \"message\"\n          }\n        ]\n      },\n      {\n        \"text\": \"\"\n      }\n    ]\n  }\n]"
              },
              "returnRequestParameters": {
                "value": true
              },
              "backgroundColor": {
                "value": "#7ed321ff"
              },
              "nodeTitle": {
                "value": "Return success"
              }
            }
          },
          "position": {
            "x": 364,
            "y": 476
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        },
        {
          "data": {
            "id": "tge3sib1fi",
            "nodeType": "EVAL"
          },
          "position": {
            "x": 484,
            "y": 266
          },
          "group": "nodes",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": false,
          "classes": ""
        }
      ],
      "edges": [
        {
          "data": {
            "id": "7eqix6mbj2",
            "source": "7reye1na3m",
            "target": "j6d583cc1k"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        },
        {
          "data": {
            "id": "rmfj6udum0",
            "source": "igvp44kqec",
            "target": "sq4k1w353i"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        },
        {
          "data": {
            "id": "gmbsovo277",
            "source": "sq4k1w353i",
            "target": "1e8wrbj11b"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        },
        {
          "data": {
            "id": "qkvb0o3er9",
            "source": "1e8wrbj11b",
            "target": "2wocyzlkv1"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        },
        {
          "data": {
            "id": "vh3bys4pqp",
            "source": "2wocyzlkv1",
            "target": "7reye1na3m"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        },
        {
          "data": {
            "id": "cuzw4xi784",
            "source": "j6d583cc1k",
            "target": "ym9toqffq3"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        },
        {
          "data": {
            "id": "r4mswgklad",
            "source": "j6d583cc1k",
            "target": "50gb66xxzb"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        },
        {
          "data": {
            "id": "yu3ury4zzy",
            "source": "ym9toqffq3",
            "target": "tge3sib1fi"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        },
        {
          "data": {
            "id": "l5gd6egzud",
            "source": "tge3sib1fi",
            "target": "1e8wrbj11b"
          },
          "position": {
            "x": 0,
            "y": 0
          },
          "group": "edges",
          "removed": false,
          "selected": false,
          "selectable": true,
          "locked": false,
          "grabbable": true,
          "pannable": true,
          "classes": ""
        }
      ]
    },
    "data": {},
    "zoomingEnabled": true,
    "userZoomingEnabled": true,
    "zoom": 1,
    "minZoom": 1e-50,
    "maxZoom": 1e+50,
    "panningEnabled": true,
    "userPanningEnabled": true,
    "pan": {
      "x": 0,
      "y": 0
    },
    "boxSelectionEnabled": true,
    "renderer": {
      "name": "null"
    }
  },
  "inputSchema": [
    {
      "propertyName": "username",
      "description": "",
      "preferredDataType": "string",
      "preferredControlType": "textField",
      "isExpanded": true,
      "required": true
    }
  ],
  "deployedAt": "2026-01-12T22:53:48.825Z"
}